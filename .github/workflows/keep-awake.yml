name: Keep Render Apps Alive

on:
  schedule:
    - cron: '*/10 * * * *'
  workflow_dispatch:

env:
  RENDER_APPS: |
    https://basketball-match-1.onrender.com
    https://score-ahze.onrender.com

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
      - name: ğŸš€ å¯åŠ¨ä¿æ´»ä»»åŠ¡
        run: |
          set +e  # å…è®¸å‘½ä»¤å¤±è´¥ç»§ç»­æ‰§è¡Œ
          
          echo "å¼€å§‹æ—¶é—´: $(date)"
          echo "GitHub Actions Runner IP: $(curl -s ifconfig.me)"
          echo "========================================"
          
          # è¯»å–åº”ç”¨åˆ—è¡¨
          apps=($(echo "$RENDER_APPS" | tr '\n' ' '))
          
          for app in "${apps[@]}"; do
            if [ -n "$app" ]; then
              echo "ğŸŒ è®¿é—®: $app"
              
              # ç¬¬ä¸€æ¬¡è®¿é—® - ä½¿ç”¨æ›´ç®€å•çš„curlå‘½ä»¤
              echo "  ç¬¬ä¸€æ¬¡è¯·æ±‚..."
              start_time=$(date +%s)
              curl -s --max-time 60 "$app" > /dev/null 2>&1
              curl_exit_code=$?
              end_time=$(date +%s)
              duration=$((end_time - start_time))
              
              if [ $curl_exit_code -eq 0 ]; then
                echo "  âœ… ç¬¬ä¸€æ¬¡è¯·æ±‚æˆåŠŸï¼Œè€—æ—¶: ${duration}s"
              else
                echo "  âš ï¸ ç¬¬ä¸€æ¬¡è¯·æ±‚å¯èƒ½è¶…æ—¶æˆ–å¤±è´¥ï¼Œé€€å‡ºç : $curl_exit_code"
              fi
              
              sleep 2
              
              # ç¬¬äºŒæ¬¡è®¿é—®
              echo "  ç¬¬äºŒæ¬¡è¯·æ±‚..."
              start_time=$(date +%s)
              curl -s --max-time 30 "$app" > /dev/null 2>&1
              curl_exit_code=$?
              end_time=$(date +%s)
              duration=$((end_time - start_time))
              
              if [ $curl_exit_code -eq 0 ]; then
                echo "  âœ… ç¬¬äºŒæ¬¡è¯·æ±‚æˆåŠŸï¼Œè€—æ—¶: ${duration}s"
              else
                echo "  âš ï¸ ç¬¬äºŒæ¬¡è¯·æ±‚å¯èƒ½è¶…æ—¶æˆ–å¤±è´¥ï¼Œé€€å‡ºç : $curl_exit_code"
              fi
              
              echo "---"
            fi
          done
          
          echo "========================================"
          echo "ç»“æŸæ—¶é—´: $(date)"
          echo "ğŸ‰ ä¿æ´»ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼ˆå…è®¸éƒ¨åˆ†å¤±è´¥ï¼‰"
